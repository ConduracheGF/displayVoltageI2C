###############################################################################
#
# IAR C/C++ Compiler V7.30.5.1680 for Microchip AVR       18/Jan/2026  10:22:17
# Copyright 1996-2022 IAR Systems AB.
#
#    Source file  =  
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\functii_timer.c
#    Command line =  
#        -f C:\Users\student\AppData\Local\Temp\EW42FC.tmp
#        (C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\functii_timer.c
#        --cpu=m1280 -ms -o
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\Debug\Obj
#        -lC
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\Debug\List
#        -lA
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\Debug\List
#        -y --initializers_in_flash --no_cse --no_inline --no_code_motion
#        --no_cross_call --no_clustering --no_tbaa --debug
#        -DENABLE_BIT_DEFINITIONS -e --eeprom_size 4096 --dlib --dlib_config
#        "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.4\avr\LIB\DLIB\dlAVR-3s-ec_mul-n.h" -On)
#    Locale       =  English_USA.1252
#    List file    =  
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\Debug\List\functii_timer.lst
#    Object file  =  
#        C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\Debug\Obj\functii_timer.r90
#
###############################################################################

C:\Users\student\Downloads\displayVoltageI2C-20260118T071946Z-1-001\displayVoltageI2C\cod\functii_timer.c
      1          #include "functii_timer.h"
      2          #include <ioavr.h>

   \                                 In  segment ABSOLUTE, at 0x6e
   \   union <unnamed> volatile __io _A_TIMSK0
   \                     _A_TIMSK0:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x47
   \   union <unnamed> volatile __io _A_OCR0A
   \                     _A_OCR0A:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x45
   \   union <unnamed> volatile __io _A_TCCR0B
   \                     _A_TCCR0B:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x44
   \   union <unnamed> volatile __io _A_TCCR0A
   \                     _A_TCCR0A:
   \   00000000                      DS8 1
      3          #include "functii_timer.h"
      4          #include <ioavr.h>
      5          #include <intrinsics.h>
      6          

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
      7          volatile uint16_t ms_ticks = 0;
   \                     ms_ticks:
   \   00000000                      DS8 2
      8          
      9          typedef enum {
     10              TIMER_COUNTER,
     11              TIMER_WAIT,
     12              TIMER_EXPIRED
     13          } timer_state_t;
     14          

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
     15          static timer_state_t timer_state = TIMER_COUNTER;
   \                     timer_state:
   \   00000000                      DS8 1

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
     16          static uint16_t start_time = 0;
   \                     start_time:
   \   00000000                      DS8 2
     17          

   \                                 In  segment CODE, align 2, keep-with-next
     18          void Timer0_Init(void) {
   \                     Timer0_Init:
     19              TCCR0A = (1 << WGM01); // CTC
   \   00000000   E002               LDI     R16, 2
   \   00000002   BD04               OUT     0x24, R16
     20              TCCR0B = (1 << CS01) | (1 << CS00); // Prescaler 64
   \   00000004   E003               LDI     R16, 3
   \   00000006   BD05               OUT     0x25, R16
     21              OCR0A = 249; // 1ms la 16MHz
   \   00000008   EF09               LDI     R16, 249
   \   0000000A   BD07               OUT     0x27, R16
     22              TIMSK0 |= (1 << OCIE0A); 
   \   0000000C   9100006E           LDS     R16, 110
   \   00000010   6002               ORI     R16, 0x02
   \   00000012   9300006E           STS     110, R16
     23          }
   \   00000016   9508               RET
   \   00000018                      REQUIRE _A_TCCR0A
   \   00000018                      REQUIRE _A_TCCR0B
   \   00000018                      REQUIRE _A_OCR0A
   \   00000018                      REQUIRE _A_TIMSK0
     24          
     25          #pragma vector = TIMER0_COMPA_vect

   \                                 In  segment CODE, align 2, keep-with-next
     26          __interrupt void TIMER0_ISR(void) {
   \                     TIMER0_ISR:
   \   00000000   93FA               ST      -Y, R31
   \   00000002   93EA               ST      -Y, R30
   \   00000004   933A               ST      -Y, R19
   \   00000006   932A               ST      -Y, R18
   \   00000008   931A               ST      -Y, R17
   \   0000000A   930A               ST      -Y, R16
   \   0000000C   B72F               IN      R18, 0x3F
   \   0000000E   B73B               IN      R19, 0x3B
     27              ms_ticks++;
   \   00000010   ....               LDI     R30, LOW(ms_ticks)
   \   00000012   ....               LDI     R31, (ms_ticks) >> 8
   \   00000014   8100               LD      R16, Z
   \   00000016   8111               LDD     R17, Z+1
   \   00000018   5F0F               SUBI    R16, 255
   \   0000001A   4F1F               SBCI    R17, 255
   \   0000001C   8300               ST      Z, R16
   \   0000001E   8311               STD     Z+1, R17
     28          }
   \   00000020   BF3B               OUT     0x3B, R19
   \   00000022   BF2F               OUT     0x3F, R18
   \   00000024   9109               LD      R16, Y+
   \   00000026   9119               LD      R17, Y+
   \   00000028   9129               LD      R18, Y+
   \   0000002A   9139               LD      R19, Y+
   \   0000002C   91E9               LD      R30, Y+
   \   0000002E   91F9               LD      R31, Y+
   \   00000030   9518               RETI
     29          
     30          // Aceasta functie gestioneaza masina de stari a timer-ului

   \                                 In  segment CODE, align 2, keep-with-next
     31          bool Timer_Check(void) {
   \                     Timer_Check:
     32              bool ready = false;
   \   00000000   E000               LDI     R16, 0
     33              
     34              switch (timer_state) {
   \   00000002   9110....           LDS     R17, timer_state
   \   00000006   5010               SUBI    R17, 0
   \   00000008   F029               BREQ    ??Timer_Check_0
   \   0000000A   951A               DEC     R17
   \   0000000C   F079               BREQ    ??Timer_Check_1
   \   0000000E   951A               DEC     R17
   \   00000010   F0F9               BREQ    ??Timer_Check_2
   \   00000012   9508               RET
     35                  case TIMER_COUNTER:
     36                      start_time = ms_ticks;
   \                     ??Timer_Check_0:
   \   00000014   ....               LDI     R30, LOW(ms_ticks)
   \   00000016   ....               LDI     R31, (ms_ticks) >> 8
   \   00000018   8120               LD      R18, Z
   \   0000001A   8131               LDD     R19, Z+1
   \   0000001C   ....               LDI     R30, LOW(start_time)
   \   0000001E   ....               LDI     R31, (start_time) >> 8
   \   00000020   8320               ST      Z, R18
   \   00000022   8331               STD     Z+1, R19
     37                      timer_state = TIMER_WAIT;
   \   00000024   E011               LDI     R17, 1
   \   00000026   9310....           STS     timer_state, R17
     38                      break;
   \   0000002A   9508               RET
     39          
     40                  case TIMER_WAIT:
     41                      if ((uint16_t)(ms_ticks - start_time) >= 200) {
   \                     ??Timer_Check_1:
   \   0000002C   ....               LDI     R30, LOW(ms_ticks)
   \   0000002E   ....               LDI     R31, (ms_ticks) >> 8
   \   00000030   8120               LD      R18, Z
   \   00000032   8131               LDD     R19, Z+1
   \   00000034   ....               LDI     R30, LOW(start_time)
   \   00000036   ....               LDI     R31, (start_time) >> 8
   \   00000038   8140               LD      R20, Z
   \   0000003A   8151               LDD     R21, Z+1
   \   0000003C   1B24               SUB     R18, R20
   \   0000003E   0B35               SBC     R19, R21
   \   00000040   3C28               CPI     R18, 200
   \   00000042   E010               LDI     R17, 0
   \   00000044   0731               CPC     R19, R17
   \   00000046   F040               BRCS    ??Timer_Check_3
     42                          timer_state = TIMER_EXPIRED;
   \   00000048   E012               LDI     R17, 2
   \   0000004A   9310....           STS     timer_state, R17
     43                      }
     44                      break;
   \   0000004E   9508               RET
     45          
     46                  case TIMER_EXPIRED:
     47                      ready = true;
   \                     ??Timer_Check_2:
   \   00000050   E001               LDI     R16, 1
     48                      timer_state = TIMER_COUNTER; // Resetam automat pentru urmatorul ciclu
   \   00000052   E010               LDI     R17, 0
   \   00000054   9310....           STS     timer_state, R17
     49                      break;
     50              }
     51              return ready;
   \                     ??Timer_Check_3:
   \   00000058   9508               RET
     52          }
     53          

   \                                 In  segment CODE, align 2, keep-with-next
     54          void delay_secunde(uint16_t time){
   \                     delay_secunde:
   \   00000000   9724               SBIW    R29:R28, 4
     55              volatile uint32_t i;
     56              while (time--) {
   \                     ??delay_secunde_0:
   \   00000002   0198               MOVW    R19:R18, R17:R16
   \   00000004   0189               MOVW    R17:R16, R19:R18
   \   00000006   5001               SUBI    R16, 1
   \   00000008   4010               SBCI    R17, 0
   \   0000000A   2B23               OR      R18, R19
   \   0000000C   F109               BREQ    ??delay_secunde_1
     57                  i = 0;
   \   0000000E   E040               LDI     R20, 0
   \   00000010   E050               LDI     R21, 0
   \   00000012   E060               LDI     R22, 0
   \   00000014   E070               LDI     R23, 0
   \   00000016   8348               ST      Y, R20
   \   00000018   8359               STD     Y+1, R21
   \   0000001A   836A               STD     Y+2, R22
   \   0000001C   837B               STD     Y+3, R23
     58                  while (i < 2000000UL) i++;
   \                     ??delay_secunde_2:
   \   0000001E   8148               LD      R20, Y
   \   00000020   8159               LDD     R21, Y+1
   \   00000022   816A               LDD     R22, Y+2
   \   00000024   817B               LDD     R23, Y+3
   \   00000026   3840               CPI     R20, 128
   \   00000028   E824               LDI     R18, 132
   \   0000002A   0752               CPC     R21, R18
   \   0000002C   E12E               LDI     R18, 30
   \   0000002E   0762               CPC     R22, R18
   \   00000030   E020               LDI     R18, 0
   \   00000032   0772               CPC     R23, R18
   \   00000034   F730               BRCC    ??delay_secunde_0
   \   00000036   8148               LD      R20, Y
   \   00000038   8159               LDD     R21, Y+1
   \   0000003A   816A               LDD     R22, Y+2
   \   0000003C   817B               LDD     R23, Y+3
   \   0000003E   5F4F               SUBI    R20, 255
   \   00000040   4F5F               SBCI    R21, 255
   \   00000042   4F6F               SBCI    R22, 255
   \   00000044   4F7F               SBCI    R23, 255
   \   00000046   8348               ST      Y, R20
   \   00000048   8359               STD     Y+1, R21
   \   0000004A   836A               STD     Y+2, R22
   \   0000004C   837B               STD     Y+3, R23
   \   0000004E   CFE7               RJMP    ??delay_secunde_2
     59              }
     60          }
   \                     ??delay_secunde_1:
   \   00000050   9624               ADIW    R29:R28, 4
   \   00000052   9508               RET
     61          

   \                                 In  segment CODE, align 2, keep-with-next
     62          void delay_milisecunde(uint32_t time){
   \                     delay_milisecunde:
   \   00000000   9724               SBIW    R29:R28, 4
     63              volatile uint32_t i;
     64              while (time--) {
   \                     ??delay_milisecunde_0:
   \   00000002   01A8               MOVW    R21:R20, R17:R16
   \   00000004   01B9               MOVW    R23:R22, R19:R18
   \   00000006   018A               MOVW    R17:R16, R21:R20
   \   00000008   019B               MOVW    R19:R18, R23:R22
   \   0000000A   5001               SUBI    R16, 1
   \   0000000C   4010               SBCI    R17, 0
   \   0000000E   4020               SBCI    R18, 0
   \   00000010   4030               SBCI    R19, 0
   \   00000012   2B45               OR      R20, R21
   \   00000014   2B46               OR      R20, R22
   \   00000016   2B47               OR      R20, R23
   \   00000018   F109               BREQ    ??delay_milisecunde_1
     65                  i = 0;
   \   0000001A   E040               LDI     R20, 0
   \   0000001C   E050               LDI     R21, 0
   \   0000001E   E060               LDI     R22, 0
   \   00000020   E070               LDI     R23, 0
   \   00000022   8348               ST      Y, R20
   \   00000024   8359               STD     Y+1, R21
   \   00000026   836A               STD     Y+2, R22
   \   00000028   837B               STD     Y+3, R23
     66                  while (i < 2000UL) i++;
   \                     ??delay_milisecunde_2:
   \   0000002A   8148               LD      R20, Y
   \   0000002C   8159               LDD     R21, Y+1
   \   0000002E   816A               LDD     R22, Y+2
   \   00000030   817B               LDD     R23, Y+3
   \   00000032   3D40               CPI     R20, 208
   \   00000034   E0E7               LDI     R30, 7
   \   00000036   075E               CPC     R21, R30
   \   00000038   E0E0               LDI     R30, 0
   \   0000003A   076E               CPC     R22, R30
   \   0000003C   E0E0               LDI     R30, 0
   \   0000003E   077E               CPC     R23, R30
   \   00000040   F700               BRCC    ??delay_milisecunde_0
   \   00000042   8148               LD      R20, Y
   \   00000044   8159               LDD     R21, Y+1
   \   00000046   816A               LDD     R22, Y+2
   \   00000048   817B               LDD     R23, Y+3
   \   0000004A   5F4F               SUBI    R20, 255
   \   0000004C   4F5F               SBCI    R21, 255
   \   0000004E   4F6F               SBCI    R22, 255
   \   00000050   4F7F               SBCI    R23, 255
   \   00000052   8348               ST      Y, R20
   \   00000054   8359               STD     Y+1, R21
   \   00000056   836A               STD     Y+2, R22
   \   00000058   837B               STD     Y+3, R23
   \   0000005A   CFE7               RJMP    ??delay_milisecunde_2
     67              }
     68          }
   \                     ??delay_milisecunde_1:
   \   0000005C   9624               ADIW    R29:R28, 4
   \   0000005E   9508               RET
     69          

   \                                 In  segment CODE, align 2, keep-with-next
     70          void delay_microsecunde(uint16_t time){
   \                     delay_microsecunde:
   \   00000000   01AC               MOVW    R21:R20, R25:R24
   \   00000002   9722               SBIW    R29:R28, 2
     71              volatile uint16_t i;
     72              while (time--) {
   \                     ??delay_microsecunde_0:
   \   00000004   0198               MOVW    R19:R18, R17:R16
   \   00000006   0189               MOVW    R17:R16, R19:R18
   \   00000008   5001               SUBI    R16, 1
   \   0000000A   4010               SBCI    R17, 0
   \   0000000C   2B23               OR      R18, R19
   \   0000000E   F079               BREQ    ??delay_microsecunde_1
     73                  i = 0;
   \   00000010   E020               LDI     R18, 0
   \   00000012   E030               LDI     R19, 0
   \   00000014   8328               ST      Y, R18
   \   00000016   8339               STD     Y+1, R19
     74                  while (i < 2) i++;
   \                     ??delay_microsecunde_2:
   \   00000018   8188               LD      R24, Y
   \   0000001A   8199               LDD     R25, Y+1
   \   0000001C   9702               SBIW    R25:R24, 2
   \   0000001E   F790               BRCC    ??delay_microsecunde_0
   \   00000020   8128               LD      R18, Y
   \   00000022   8139               LDD     R19, Y+1
   \   00000024   5F2F               SUBI    R18, 255
   \   00000026   4F3F               SBCI    R19, 255
   \   00000028   8328               ST      Y, R18
   \   0000002A   8339               STD     Y+1, R19
   \   0000002C   CFF5               RJMP    ??delay_microsecunde_2
     75              }
     76          }
   \                     ??delay_microsecunde_1:
   \   0000002E   9622               ADIW    R29:R28, 2
   \   00000030   01CA               MOVW    R25:R24, R21:R20
   \   00000032   9508               RET

   \                                 In  segment INTVEC, offset 0x54, root
   \                     `??TIMER0_ISR::??INTVEC 84`:
   \   00000054   ........           JMP     TIMER0_ISR

   Maximum stack usage in bytes:

   CSTACK RSTACK Function
   ------ ------ --------
      6      2   TIMER0_ISR
      0      2   Timer0_Init
      0      2   Timer_Check
      2      2   delay_microsecunde
      4      2   delay_milisecunde
      4      2   delay_secunde


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      50  TIMER0_ISR
       4  TIMER0_ISR::??INTVEC 84
      24  Timer0_Init
      90  Timer_Check
       1  _A_OCR0A
       1  _A_TCCR0A
       1  _A_TCCR0B
       1  _A_TIMSK0
      52  delay_microsecunde
      96  delay_milisecunde
      84  delay_secunde
       2  ms_ticks
       2  start_time
       1  timer_state
       7  -- Other

 
   4 bytes in segment ABSOLUTE
 396 bytes in segment CODE
   7 bytes in segment INITTAB
   4 bytes in segment INTVEC
   5 bytes in segment NEAR_Z
 
 396 bytes of CODE memory (+ 11 bytes shared)
   5 bytes of DATA memory (+  4 bytes shared)

Errors: none
Warnings: none
